{"id": 51, "nl": "For each id and year, compute the ratio of black population to white population as a percentage.", "sql": "SELECT id, year, CASE WHEN white != 0 THEN CAST(black AS REAL) / white * 100 ELSE 0 END AS black_to_white_percentage FROM demographics;", "complexity": "Ratio"}
{"id": 52, "nl": "For every record, calculate the percentage of hispanic_or_latino population to not_hispanic_or_latino population.", "sql": "SELECT id, year, CASE WHEN not_hispanic_or_latino != 0 THEN CAST(hispanic_or_latino AS REAL) / not_hispanic_or_latino * 100 ELSE 0 END AS hispanic_to_non_hispanic_percentage FROM demographics;", "complexity": "Ratio"}
{"id": 53, "nl": "Compute the ratio of asian population to some_other_race population for each zipcode and year.", "sql": "SELECT zipcode, year, CASE WHEN some_other_race != 0 THEN CAST(asian AS REAL) / some_other_race * 100 ELSE 0 END AS asian_to_other_percentage FROM demographics;", "complexity": "Ratio"}
{"id": 54, "nl": "For each record, find the percentage of the black population relative to the race total population.", "sql": "SELECT id, year, CASE WHEN race_total_population != 0 THEN CAST(black AS REAL) / race_total_population * 100 ELSE 0 END AS black_percentage FROM demographics;", "complexity": "Ratio"}
{"id": 55, "nl": "For each year, determine the percentage of not_hispanic_or_latino population relative to the total hispanic_or_latino_total across all zipcodes.", "sql": "SELECT year, CASE WHEN SUM(hispanic_or_latino_total) != 0 THEN SUM(CAST(not_hispanic_or_latino AS REAL)) / SUM(hispanic_or_latino_total) * 100 ELSE 0 END AS non_hispanic_percentage FROM demographics GROUP BY year;", "complexity": "Ratio"}
{"id": 56, "nl": "For each zipcode, what percent of the total race population across all years is represented by the white population?", "sql": "SELECT zipcode, CASE WHEN SUM(race_total_population) != 0 THEN SUM(CAST(white AS REAL)) / SUM(race_total_population) * 100 ELSE 0 END AS white_percentage FROM demographics GROUP BY zipcode;", "complexity": "Ratio"}
{"id": 57, "nl": "For each zipcode and year, calculate the percentage of hispanic_or_latino population relative to the race total population.", "sql": "SELECT zipcode, year, CASE WHEN race_total_population != 0 THEN CAST(hispanic_or_latino AS REAL) / race_total_population * 100 ELSE 0 END AS hispanic_percentage FROM demographics;", "complexity": "Ratio"}
{"id": 58, "nl": "Determine the ratio of two_or_more_races to one_race for each id in each year.", "sql": "SELECT id, year, CASE WHEN one_race != 0 THEN CAST(two_or_more_races AS REAL) / one_race * 100 ELSE 0 END AS mixed_to_single_percentage FROM demographics;", "complexity": "Ratio"}
{"id": 59, "nl": "For each record, compute the percentage of some_other_race relative to asian population.", "sql": "SELECT id, year, CASE WHEN asian != 0 THEN CAST(some_other_race AS REAL) / asian * 100 ELSE 0 END AS other_to_asian_percentage FROM demographics;", "complexity": "Ratio"}
{"id": 60, "nl": "Compute the percentage of american_indian_and_alaska_native population relative to race total population for each zipcode across all years.", "sql": "SELECT zipcode, CASE WHEN SUM(race_total_population) != 0 THEN SUM(CAST(american_indian_and_alaska_native AS REAL)) / SUM(race_total_population) * 100 ELSE 0 END AS native_percentage FROM demographics GROUP BY zipcode;", "complexity": "Ratio"}
{"id": 61, "nl": "Within each year, assign a row number to zipcodes based on their black population in ascending order.", "sql": "SELECT year, zipcode, black, ROW_NUMBER() OVER (PARTITION BY year ORDER BY black ASC) AS black_row FROM demographics;", "complexity": "Window"}
{"id": 62, "nl": "For each zipcode, rank years by white population in descending order.", "sql": "SELECT zipcode, year, white, RANK() OVER (PARTITION BY zipcode ORDER BY white DESC) AS white_rank FROM demographics;", "complexity": "Window"}
{"id": 63, "nl": "Rank ids within each year according to hispanic_or_latino population in descending order.", "sql": "SELECT year, id, hispanic_or_latino, RANK() OVER (PARTITION BY year ORDER BY hispanic_or_latino DESC) AS hispanic_rank FROM demographics;", "complexity": "Window"}
{"id": 64, "nl": "Compute a dense rank of zipcodes by asian population within each year in descending order.", "sql": "SELECT year, zipcode, asian, DENSE_RANK() OVER (PARTITION BY year ORDER BY asian DESC) AS asian_dense_rank FROM demographics;", "complexity": "Window"}
{"id": 65, "nl": "Assign a row number to ids within each year based on one_race population in descending order.", "sql": "SELECT year, id, one_race, ROW_NUMBER() OVER (PARTITION BY year ORDER BY one_race DESC) AS one_race_row FROM demographics;", "complexity": "Window"}
{"id": 66, "nl": "Within each zipcode, rank ids by not_hispanic_or_latino population in ascending order.", "sql": "SELECT zipcode, id, not_hispanic_or_latino, RANK() OVER (PARTITION BY zipcode ORDER BY not_hispanic_or_latino ASC) AS non_hispanic_rank FROM demographics;", "complexity": "Window"}
{"id": 67, "nl": "Compute the dense rank of zipcodes within each year by american_indian_and_alaska_native population in ascending order.", "sql": "SELECT year, zipcode, american_indian_and_alaska_native, DENSE_RANK() OVER (PARTITION BY year ORDER BY american_indian_and_alaska_native ASC) AS native_dense_rank FROM demographics;", "complexity": "Window"}
{"id": 68, "nl": "Give each zipcode a row number across the entire table ordered by race_total_population in descending order.", "sql": "SELECT zipcode, year, race_total_population, ROW_NUMBER() OVER (ORDER BY race_total_population DESC) AS total_row FROM demographics;", "complexity": "Window"}
{"id": 69, "nl": "Within each id, rank zipcodes by some_other_race in descending order.", "sql": "SELECT id, zipcode, some_other_race, RANK() OVER (PARTITION BY id ORDER BY some_other_race DESC) AS other_race_rank FROM demographics;", "complexity": "Window"}
{"id": 70, "nl": "For each zipcode, compute a dense rank of years by two_or_more_races population in ascending order.", "sql": "SELECT zipcode, year, two_or_more_races, DENSE_RANK() OVER (PARTITION BY zipcode ORDER BY two_or_more_races ASC) AS two_races_dense_rank FROM demographics;", "complexity": "Window"}
{"id": 71, "nl": "Select records where the asian population equals the minimum asian population for that year.", "sql": "SELECT year, id, zipcode, asian FROM demographics d WHERE asian = (SELECT MIN(asian) FROM demographics WHERE year = d.year);", "complexity": "Subquery"}
{"id": 72, "nl": "List ids whose total black population across all years is greater than the average black population across all ids.", "sql": "SELECT id, SUM(black) AS total_black FROM demographics GROUP BY id HAVING SUM(black) > (SELECT AVG(total_black) FROM (SELECT id, SUM(black) AS total_black FROM demographics GROUP BY id));", "complexity": "Subquery"}
{"id": 73, "nl": "Find zipcodes where the white population in a given year is less than the average white population of that year.", "sql": "SELECT year, zipcode, white FROM demographics d WHERE white < (SELECT AVG(white) FROM demographics WHERE year = d.year);", "complexity": "Subquery"}
{"id": 74, "nl": "Return years that appear only once in the demographics table.", "sql": "SELECT DISTINCT year FROM demographics WHERE year IN (SELECT year FROM demographics GROUP BY year HAVING COUNT(*) = 1);", "complexity": "Subquery"}
{"id": 75, "nl": "List id and year where the white population is equal to the minimum white population for that id across all years.", "sql": "SELECT id, year, white FROM demographics d WHERE white = (SELECT MIN(white) FROM demographics WHERE id = d.id);", "complexity": "Subquery"}
{"id": 76, "nl": "Retrieve all records where the hispanic_or_latino population is at least twice the maximum some_other_race population for the same zipcode.", "sql": "SELECT id, year, zipcode, hispanic_or_latino, some_other_race FROM demographics d WHERE hispanic_or_latino >= 2 * (SELECT MAX(some_other_race) FROM demographics WHERE zipcode = d.zipcode);", "complexity": "Subquery"}
{"id": 77, "nl": "Return zipcodes that have any record in the earliest year of the table.", "sql": "SELECT DISTINCT zipcode FROM demographics WHERE year = (SELECT MIN(year) FROM demographics);", "complexity": "Subquery"}
{"id": 78, "nl": "For each zipcode, get the year when the black population was at its maximum.", "sql": "SELECT zipcode, year, black FROM demographics d WHERE black = (SELECT MAX(black) FROM demographics WHERE zipcode = d.zipcode);", "complexity": "Subquery"}
{"id": 79, "nl": "Identify id-year combinations where the one_race population is greater than the maximum two_or_more_races population in that year.", "sql": "SELECT id, year, one_race FROM demographics d WHERE one_race > (SELECT MAX(two_or_more_races) FROM demographics WHERE year = d.year);", "complexity": "Subquery"}
{"id": 80, "nl": "List zipcodes whose total hispanic_or_latino population across all years is greater than their total black population.", "sql": "SELECT DISTINCT zipcode FROM demographics WHERE zipcode IN (SELECT zipcode FROM demographics GROUP BY zipcode HAVING SUM(hispanic_or_latino) > SUM(black));", "complexity": "Subquery"}
{"id": 81, "nl": "For each record, label it 'Majority White' if white population is more than half of race total population; otherwise label it 'Not Majority White'.", "sql": "SELECT id, year, white, race_total_population, CASE WHEN race_total_population != 0 AND (CAST(white AS REAL) / race_total_population) > 0.5 THEN 'Majority White' ELSE 'Not Majority White' END AS white_majority_category FROM demographics;", "complexity": "Condition"}
{"id": 82, "nl": "Classify each record as 'High Mixed' if the two_or_more_races population is 200 or more, otherwise 'Low Mixed'.", "sql": "SELECT id, year, two_or_more_races, CASE WHEN two_or_more_races >= 200 THEN 'High Mixed' ELSE 'Low Mixed' END AS mixed_category FROM demographics;", "complexity": "Condition"}
{"id": 83, "nl": "For each record, indicate 'Hispanic Majority' if the hispanic_or_latino population constitutes more than 50 percent of the hispanic_or_latino_total, else 'Hispanic Minority'.", "sql": "SELECT id, year, hispanic_or_latino, hispanic_or_latino_total, CASE WHEN hispanic_or_latino_total != 0 AND (CAST(hispanic_or_latino AS REAL) / hispanic_or_latino_total) > 0.5 THEN 'Hispanic Majority' ELSE 'Hispanic Minority' END AS hispanic_majority_category FROM demographics;", "complexity": "Condition"}
{"id": 84, "nl": "Categorize each record as 'Diverse Race' if two_or_more_races makes up at least 10 percent of race total population, otherwise 'Less Diverse'.", "sql": "SELECT id, year, two_or_more_races, race_total_population, CASE WHEN race_total_population != 0 AND (CAST(two_or_more_races AS REAL) / race_total_population) >= 0.1 THEN 'Diverse Race' ELSE 'Less Diverse' END AS diversity_status FROM demographics;", "complexity": "Condition"}
{"id": 85, "nl": "Assign each record a size class: 'Small' if race_total_population < 500, 'Medium' if between 500 and 1000 inclusive, and 'Large' if over 1000.", "sql": "SELECT id, year, race_total_population, CASE WHEN race_total_population < 500 THEN 'Small' WHEN race_total_population BETWEEN 500 AND 1000 THEN 'Medium' ELSE 'Large' END AS size_class FROM demographics;", "complexity": "Condition"}
{"id": 86, "nl": "Group each record's year into 'Old' if the year is 2000 or earlier and '21st Century' otherwise.", "sql": "SELECT year, CASE WHEN year <= 2000 THEN 'Old' ELSE '21st Century' END AS century_category FROM demographics;", "complexity": "Condition"}
{"id": 87, "nl": "Label each record as 'More Black' if the black population exceeds the white population, else 'More White'.", "sql": "SELECT id, year, black, white, CASE WHEN black > white THEN 'More Black' ELSE 'More White' END AS black_vs_white_category FROM demographics;", "complexity": "Condition"}
{"id": 88, "nl": "Categorize each record as 'High Non-Hispanic' if the not_hispanic_or_latino population is more than twice the hispanic_or_latino population, else 'Balanced'.", "sql": "SELECT id, year, hispanic_or_latino, not_hispanic_or_latino, CASE WHEN not_hispanic_or_latino > 2 * hispanic_or_latino THEN 'High Non-Hispanic' ELSE 'Balanced' END AS non_hispanic_balance FROM demographics;", "complexity": "Condition"}
{"id": 89, "nl": "Indicate whether the combined asian and white population exceeds half of the race total population; label as 'Asian/White Majority' or 'Other Majority'.", "sql": "SELECT id, year, asian, white, race_total_population, CASE WHEN race_total_population != 0 AND (CAST(asian + white AS REAL) / race_total_population) > 0.5 THEN 'Asian/White Majority' ELSE 'Other Majority' END AS asian_white_majority FROM demographics;", "complexity": "Condition"}
{"id": 90, "nl": "Label each record 'Underrepresented Native' if american_indian_and_alaska_native is under 10, otherwise 'Represented Native'.", "sql": "SELECT id, year, american_indian_and_alaska_native, CASE WHEN american_indian_and_alaska_native < 10 THEN 'Underrepresented Native' ELSE 'Represented Native' END AS native_representation FROM demographics;", "complexity": "Condition"}
{"id": 91, "nl": "List years where the number of distinct zipcodes is greater than 10.", "sql": "SELECT year, COUNT(DISTINCT zipcode) AS zipcode_count FROM demographics GROUP BY year HAVING COUNT(DISTINCT zipcode) > 10;", "complexity": "Filter"}
{"id": 92, "nl": "Find zipcodes whose average black population is less than 100.", "sql": "SELECT zipcode, AVG(black) AS avg_black FROM demographics GROUP BY zipcode HAVING AVG(black) < 100;", "complexity": "Filter"}
{"id": 93, "nl": "Identify years where the sum of white population across all zipcodes exceeds the sum of black population.", "sql": "SELECT year, SUM(white) AS total_white, SUM(black) AS total_black FROM demographics GROUP BY year HAVING SUM(white) > SUM(black);", "complexity": "Filter"}
{"id": 94, "nl": "List ids where the maximum asian population observed is at least 500.", "sql": "SELECT id, MAX(asian) AS max_asian FROM demographics GROUP BY id HAVING MAX(asian) >= 500;", "complexity": "Filter"}
{"id": 95, "nl": "Find zipcodes whose average some_other_race population falls between 50 and 200 inclusive.", "sql": "SELECT zipcode, AVG(some_other_race) AS avg_other_race FROM demographics GROUP BY zipcode HAVING AVG(some_other_race) BETWEEN 50 AND 200;", "complexity": "Filter"}
{"id": 96, "nl": "Return years where the total hispanic_or_latino population equals the total not_hispanic_or_latino population.", "sql": "SELECT year, SUM(hispanic_or_latino) AS total_hispanic, SUM(not_hispanic_or_latino) AS total_non_hispanic FROM demographics GROUP BY year HAVING SUM(hispanic_or_latino) = SUM(not_hispanic_or_latino);", "complexity": "Filter"}
{"id": 97, "nl": "List zipcodes where the total native_hawaiian_and_other_pacific_islander population is zero across all years.", "sql": "SELECT zipcode, SUM(native_hawaiian_and_other_pacific_islander) AS total_pacific FROM demographics GROUP BY zipcode HAVING SUM(native_hawaiian_and_other_pacific_islander) = 0;", "complexity": "Filter"}
{"id": 98, "nl": "Identify ids that have data for at least three distinct years.", "sql": "SELECT id, COUNT(DISTINCT year) AS year_count FROM demographics GROUP BY id HAVING COUNT(DISTINCT year) >= 3;", "complexity": "Filter"}
{"id": 99, "nl": "Find zipcodes where the average two_or_more_races population is greater than the average one_race population.", "sql": "SELECT zipcode, AVG(two_or_more_races) AS avg_two_races, AVG(one_race) AS avg_one_race FROM demographics GROUP BY zipcode HAVING AVG(two_or_more_races) > AVG(one_race);", "complexity": "Filter"}
{"id": 100, "nl": "List years where the maximum race_total_population among all zipcodes is less than 500.", "sql": "SELECT year, MAX(race_total_population) AS max_total FROM demographics GROUP BY year HAVING MAX(race_total_population) < 500;", "complexity": "Filter"}
