{"id": 1, "nl": "For the year 2010, calculate the percentage of white population relative to the race total population for each zipcode.", "sql": "SELECT zipcode, CASE WHEN race_total_population != 0 THEN CAST(white AS REAL) / race_total_population * 100 ELSE 0 END AS white_percentage FROM demographics WHERE year = 2010;", "complexity": "Ratio"})
{"id": 2, "nl": "For each year, what percent of the total race population is made up by the hispanic_or_latino population (across all zipcodes)?", "sql": "SELECT year, CASE WHEN SUM(race_total_population) != 0 THEN SUM(CAST(hispanic_or_latino AS REAL)) / SUM(race_total_population) * 100 ELSE 0 END AS hispanic_percentage FROM demographics GROUP BY year;", "complexity": "Ratio"})
{"id": 3, "nl": "Compute the ratio of asian population to race total population for each id across all years.", "sql": "SELECT id, year, CASE WHEN race_total_population != 0 THEN CAST(asian AS REAL) / race_total_population * 100 ELSE 0 END AS asian_percentage FROM demographics;", "complexity": "Ratio"})
{"id": 4, "nl": "For each zipcode and year, what percentage of the race total population is represented by people reporting two or more races?", "sql": "SELECT zipcode, year, CASE WHEN race_total_population != 0 THEN CAST(two_or_more_races AS REAL) / race_total_population * 100 ELSE 0 END AS two_or_more_races_percentage FROM demographics;", "complexity": "Ratio"})
{"id": 5, "nl": "Find each id's percentage of one_race population relative to the race total population, and show results only if the year is 2015.", "sql": "SELECT id, CASE WHEN race_total_population != 0 THEN CAST(one_race AS REAL) / race_total_population * 100 ELSE 0 END AS one_race_percentage FROM demographics WHERE year = 2015;", "complexity": "Ratio"})
{"id": 6, "nl": "For each year, list the percentage of the black population across all zipcodes relative to the total race population.", "sql": "SELECT year, CASE WHEN SUM(race_total_population) != 0 THEN SUM(CAST(black AS REAL)) / SUM(race_total_population) * 100 ELSE 0 END AS black_percentage FROM demographics GROUP BY year ORDER BY black_percentage DESC;", "complexity": "Ratio"})
{"id": 7, "nl": "For each zipcode, what percentage of the hispanic_or_latino_total population is not_hispanic_or_latino?", "sql": "SELECT zipcode, CASE WHEN hispanic_or_latino_total != 0 THEN CAST(not_hispanic_or_latino AS REAL) / hispanic_or_latino_total * 100 ELSE 0 END AS non_hispanic_percentage FROM demographics;", "complexity": "Ratio"})
{"id": 8, "nl": "Calculate the percentage of the american_indian_and_alaska_native population for each id and year relative to the race total population.", "sql": "SELECT id, year, CASE WHEN race_total_population != 0 THEN CAST(american_indian_and_alaska_native AS REAL) / race_total_population * 100 ELSE 0 END AS native_percentage FROM demographics;", "complexity": "Ratio"})
{"id": 9, "nl": "Show the percentage of the some_other_race population to the race total population in 2015 for each zipcode.", "sql": "SELECT zipcode, CASE WHEN race_total_population != 0 THEN CAST(some_other_race AS REAL) / race_total_population * 100 ELSE 0 END AS other_race_percentage FROM demographics WHERE year = 2015;", "complexity": "Ratio"})
{"id": 10, "nl": "For each year, compute what percentage of the race total population is made up by native_hawaiian_and_other_pacific_islander population.", "sql": "SELECT year, CASE WHEN SUM(race_total_population) != 0 THEN SUM(CAST(native_hawaiian_and_other_pacific_islander AS REAL)) / SUM(race_total_population) * 100 ELSE 0 END AS pacific_islander_percentage FROM demographics GROUP BY year ORDER BY year;", "complexity": "Ratio"})
{"id": 11, "nl": "Within each year, rank the zipcodes by the white population in descending order.", "sql": "SELECT year, zipcode, white, RANK() OVER (PARTITION BY year ORDER BY white DESC) AS white_rank FROM demographics;", "complexity": "Window"})
{"id": 12, "nl": "For each zipcode, assign a row number to each year based on the asian population in descending order.", "sql": "SELECT zipcode, year, asian, ROW_NUMBER() OVER (PARTITION BY zipcode ORDER BY asian DESC) AS asian_row FROM demographics;", "complexity": "Window"})
{"id": 13, "nl": "Compute a dense rank of ids within each year ordered by the black population in ascending order.", "sql": "SELECT year, id, black, DENSE_RANK() OVER (PARTITION BY year ORDER BY black ASC) AS black_dense_rank FROM demographics;", "complexity": "Window"})
{"id": 14, "nl": "For every year, rank each zipcode by the hispanic_or_latino population from smallest to largest.", "sql": "SELECT year, zipcode, hispanic_or_latino, RANK() OVER (PARTITION BY year ORDER BY hispanic_or_latino ASC) AS hispanic_rank FROM demographics;", "complexity": "Window"})
{"id": 15, "nl": "Generate a row number per zipcode across years sorted by the not_hispanic_or_latino population in descending order.", "sql": "SELECT zipcode, year, not_hispanic_or_latino, ROW_NUMBER() OVER (PARTITION BY zipcode ORDER BY not_hispanic_or_latino DESC) AS non_hispanic_row FROM demographics;", "complexity": "Window"})
{"id": 16, "nl": "Within each year, compute the dense rank of each id based on the two_or_more_races population in descending order.", "sql": "SELECT year, id, two_or_more_races, DENSE_RANK() OVER (PARTITION BY year ORDER BY two_or_more_races DESC) AS two_races_rank FROM demographics;", "complexity": "Window"})
{"id": 17, "nl": "Assign a row number to each record within a zipcode based on some_other_race in ascending order.", "sql": "SELECT zipcode, year, some_other_race, ROW_NUMBER() OVER (PARTITION BY zipcode ORDER BY some_other_race ASC) AS other_race_row FROM demographics;", "complexity": "Window"})
{"id": 18, "nl": "Rank zipcodes within each year by the american_indian_and_alaska_native population from highest to lowest.", "sql": "SELECT year, zipcode, american_indian_and_alaska_native, RANK() OVER (PARTITION BY year ORDER BY american_indian_and_alaska_native DESC) AS native_rank FROM demographics;", "complexity": "Window"})
{"id": 19, "nl": "For each year, assign a row number to each id based on the native_hawaiian_and_other_pacific_islander population in descending order.", "sql": "SELECT year, id, native_hawaiian_and_other_pacific_islander, ROW_NUMBER() OVER (PARTITION BY year ORDER BY native_hawaiian_and_other_pacific_islander DESC) AS pacific_row FROM demographics;", "complexity": "Window"})
{"id": 20, "nl": "Within each id, rank the years by race_total_population in descending order.", "sql": "SELECT id, year, race_total_population, RANK() OVER (PARTITION BY id ORDER BY race_total_population DESC) AS total_rank FROM demographics;", "complexity": "Window"})
{"id": 21, "nl": "Find each year and zipcode where the white population equals the maximum white population within that year.", "sql": "SELECT year, zipcode, white FROM demographics d WHERE white = (SELECT MAX(white) FROM demographics WHERE year = d.year);", "complexity": "Subquery"})
{"id": 22, "nl": "List id and year for records where the black population is greater than the overall average black population across the table.", "sql": "SELECT id, year, black FROM demographics WHERE black > (SELECT AVG(black) FROM demographics);", "complexity": "Subquery"})
{"id": 23, "nl": "Return zipcodes that have any record where hispanic_or_latino population exceeds some_other_race population.", "sql": "SELECT DISTINCT zipcode FROM demographics WHERE zipcode IN (SELECT zipcode FROM demographics WHERE hispanic_or_latino > some_other_race);", "complexity": "Subquery"})
{"id": 24, "nl": "For each zipcode, show its maximum race_total_population across all years.", "sql": "SELECT DISTINCT zipcode, (SELECT MAX(race_total_population) FROM demographics d2 WHERE d2.zipcode = d1.zipcode) AS max_race_total_population FROM demographics d1;", "complexity": "Subquery"})
{"id": 25, "nl": "Retrieve all records from the earliest year present in the demographics table.", "sql": "SELECT * FROM demographics WHERE year = (SELECT MIN(year) FROM demographics);", "complexity": "Subquery"})
pairs.append({"id": 26, "nl": "Find zipcodes that have at least one year where asian population is greater than or equal to the black population.", "sql": "SELECT DISTINCT zipcode FROM demographics WHERE zipcode IN (SELECT zipcode FROM demographics WHERE asian >= black);", "complexity": "Subquery"})
pairs.append({"id": 27, "nl": "List id and year where the hispanic_or_latino population is greater than the average hispanic_or_latino population for that same year.", "sql": "SELECT id, year, hispanic_or_latino FROM demographics d1 WHERE hispanic_or_latino > (SELECT AVG(hispanic_or_latino) FROM demographics d2 WHERE d2.year = d1.year);", "complexity": "Subquery"})
pairs.append({"id": 28, "nl": "Identify zipcodes whose total one_race population across all years exceeds 1000.", "sql": "SELECT DISTINCT zipcode FROM demographics WHERE zipcode IN (SELECT zipcode FROM demographics GROUP BY zipcode HAVING SUM(one_race) > 1000);", "complexity": "Subquery"})
pairs.append({"id": 29, "nl": "Return id and year where the not_hispanic_or_latino population is the minimum value for that zipcode.", "sql": "SELECT id, year, not_hispanic_or_latino FROM demographics d1 WHERE not_hispanic_or_latino = (SELECT MIN(not_hispanic_or_latino) FROM demographics d2 WHERE d2.zipcode = d1.zipcode);", "complexity": "Subquery"})
pairs.append({"id": 30, "nl": "Get year and zipcode where the race_total_population equals the maximum race_total_population recorded for that zipcode.", "sql": "SELECT year, zipcode, race_total_population FROM demographics d WHERE race_total_population = (SELECT MAX(race_total_population) FROM demographics WHERE zipcode = d.zipcode);", "complexity": "Subquery"})
pairs.append({"id": 31, "nl": "For each record, indicate whether the white population or the black population is larger by adding a column labeled dominant_group.", "sql": "SELECT year, id, zipcode, white, black, CASE WHEN white > black THEN 'White' WHEN black > white THEN 'Black' ELSE 'Equal' END AS dominant_group FROM demographics;", "complexity": "Condition"})
pairs.append({"id": 32, "nl": "Create a classification for each record called hispanic_category that says 'High Hispanic' if hispanic_or_latino is greater than 500, otherwise 'Low Hispanic'.", "sql": "SELECT id, year, hispanic_or_latino, CASE WHEN hispanic_or_latino > 500 THEN 'High Hispanic' ELSE 'Low Hispanic' END AS hispanic_category FROM demographics;", "complexity": "Condition"})
pairs.append({"id": 33, "nl": "For each year, count how many records have asian population over 100 and label them as 'High Asian' or 'Low Asian'.", "sql": "SELECT year, SUM(CASE WHEN asian > 100 THEN 1 ELSE 0 END) AS high_asian_count, SUM(CASE WHEN asian <= 100 THEN 1 ELSE 0 END) AS low_asian_count FROM demographics GROUP BY year;", "complexity": "Condition"})
pairs.append({"id": 34, "nl": "For each zipcode, classify whether the population reporting two_or_more_races is larger than the one_race population as 'More Mixed' or 'More Single'.", "sql": "SELECT zipcode, year, one_race, two_or_more_races, CASE WHEN two_or_more_races > one_race THEN 'More Mixed' ELSE 'More Single' END AS race_mix_category FROM demographics;", "complexity": "Condition"})
pairs.append({"id": 35, "nl": "Categorize each record's year as 'Early' if before 2010, 'Mid' if between 2010 and 2015 inclusive, and 'Late' if after 2015.", "sql": "SELECT year, CASE WHEN year < 2010 THEN 'Early' WHEN year BETWEEN 2010 AND 2015 THEN 'Mid' ELSE 'Late' END AS time_period FROM demographics;", "complexity": "Condition"})
{"id": 36, "nl": "Label each record as 'Large Total' when the race_total_population is at least 1000 and 'Small Total' otherwise.", "sql": "SELECT id, year, race_total_population, CASE WHEN race_total_population >= 1000 THEN 'Large Total' ELSE 'Small Total' END AS size_category FROM demographics;", "complexity": "Condition"})
{"id": 37, "nl": "Create a category that says 'Predominantly Hispanic' if hispanic_or_latino is greater than not_hispanic_or_latino, otherwise 'Predominantly Non-Hispanic'.", "sql": "SELECT id, year, hispanic_or_latino, not_hispanic_or_latino, CASE WHEN hispanic_or_latino > not_hispanic_or_latino THEN 'Predominantly Hispanic' ELSE 'Predominantly Non-Hispanic' END AS ethnicity_category FROM demographics;", "complexity": "Condition"})
{"id": 38, "nl": "Indicate whether the american_indian_and_alaska_native population is high or low using a threshold of 50.", "sql": "SELECT id, year, american_indian_and_alaska_native, CASE WHEN american_indian_and_alaska_native >= 50 THEN 'High Native' ELSE 'Low Native' END AS native_category FROM demographics;", "complexity": "Condition"})
{"id": 39, "nl": "For each record, categorize the not_hispanic_or_latino share into 'Majority' if it makes up more than 60 percent of hispanic_or_latino_total, otherwise 'Minority'.", "sql": "SELECT id, year, not_hispanic_or_latino, hispanic_or_latino_total, CASE WHEN hispanic_or_latino_total != 0 AND (CAST(not_hispanic_or_latino AS REAL) / hispanic_or_latino_total) > 0.6 THEN 'Majority' ELSE 'Minority' END AS non_hispanic_category FROM demographics;", "complexity": "Condition"})
{"id": 40, "nl": "Indicate whether each record is 'Diverse' if two_or_more_races exceeds one_race, otherwise 'Homogeneous'.", "sql": "SELECT id, year, one_race, two_or_more_races, CASE WHEN two_or_more_races > one_race THEN 'Diverse' ELSE 'Homogeneous' END AS diversity_category FROM demographics;", "complexity": "Condition"})
{"id": 41, "nl": "Identify zipcodes whose average race_total_population across all years is greater than 1000.", "sql": "SELECT zipcode, AVG(race_total_population) AS avg_total_pop FROM demographics GROUP BY zipcode HAVING AVG(race_total_population) > 1000;", "complexity": "Filter"})
{"id": 42, "nl": "List years where the total asian population across all zipcodes exceeds 5000.", "sql": "SELECT year, SUM(asian) AS total_asian FROM demographics GROUP BY year HAVING SUM(asian) > 5000;", "complexity": "Filter"})
{"id": 43, "nl": "Find zipcodes where the maximum white population is less than 100.", "sql": "SELECT zipcode, MAX(white) AS max_white FROM demographics GROUP BY zipcode HAVING MAX(white) < 100;", "complexity": "Filter"})
{"id": 44, "nl": "List id and zipcode combinations that appear more than twice in the data.", "sql": "SELECT id, zipcode, COUNT(*) AS record_count FROM demographics GROUP BY id, zipcode HAVING COUNT(*) > 2;", "complexity": "Filter"})
{"id": 45, "nl": "Determine years where the average black population falls between 200 and 500.", "sql": "SELECT year, AVG(black) AS avg_black FROM demographics GROUP BY year HAVING AVG(black) BETWEEN 200 AND 500;", "complexity": "Filter"})
{"id": 46, "nl": "Find zipcodes where the sum of hispanic_or_latino population is less than the sum of not_hispanic_or_latino across all years.", "sql": "SELECT zipcode, SUM(hispanic_or_latino) AS total_hispanic, SUM(not_hispanic_or_latino) AS total_non_hispanic FROM demographics GROUP BY zipcode HAVING SUM(hispanic_or_latino) < SUM(not_hispanic_or_latino);", "complexity": "Filter"})
{"id": 47, "nl": "Return years where the total two_or_more_races population across all zipcodes exceeds the total one_race population.", "sql": "SELECT year, SUM(two_or_more_races) AS total_two_races, SUM(one_race) AS total_one_race FROM demographics GROUP BY year HAVING SUM(two_or_more_races) > SUM(one_race);", "complexity": "Filter"})
{"id": 48, "nl": "List zipcodes where the maximum hispanic_or_latino population is greater than 1000.", "sql": "SELECT zipcode, MAX(hispanic_or_latino) AS max_hispanic FROM demographics GROUP BY zipcode HAVING MAX(hispanic_or_latino) > 1000;", "complexity": "Filter"})
{"id": 49, "nl": "Find years where the average american_indian_and_alaska_native population is greater than 50.", "sql": "SELECT year, AVG(american_indian_and_alaska_native) AS avg_native FROM demographics GROUP BY year HAVING AVG(american_indian_and_alaska_native) > 50;", "complexity": "Filter"})
{"id": 50, "nl": "Identify zipcodes that have at least one year with zero some_other_race population.", "sql": "SELECT zipcode, MIN(some_other_race) AS min_other_race FROM demographics GROUP BY zipcode HAVING MIN(some_other_race) = 0;", "complexity": "Filter"})
